"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[337],{302(e,a,s){s.d(a,{A:()=>n});var o=s(43),r=s(368),t=s(579);const n=function(e){var a;let{showProfile:s=!0}=e;const n=(0,r.Zp)(),[l,i]=(0,o.useState)(null),[c,d]=(0,o.useState)(!1);(0,o.useEffect)(()=>{const e=localStorage.getItem("user");e&&i(JSON.parse(e))},[]);const m=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"U";return(0,t.jsxs)("header",{className:"navbar",children:[(0,t.jsx)("div",{className:"nav-left",children:(0,t.jsx)("div",{className:"logo",onClick:()=>n("/"),children:(0,t.jsx)("img",{src:"/img/logo.png",alt:"E Siksha Logo"})})}),(0,t.jsx)("div",{className:"nav-right",children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("nav",{className:"nav-links",children:[(0,t.jsx)("button",{className:"nav-link",onClick:()=>n("/"),children:"Home"}),(0,t.jsx)("button",{className:"nav-link",onClick:()=>n("/list"),children:"Courses"}),(0,t.jsx)("button",{className:"nav-link",onClick:()=>n("/pdf"),children:"Notes"}),(0,t.jsx)("button",{className:"nav-link",onClick:()=>n("/about"),children:"About"})]}),l?(0,t.jsxs)("div",{className:"user-profile",onClick:()=>d(!c),children:[l.avatar?(0,t.jsx)("img",{src:l.avatar,alt:l.fullName,className:"user-avatar"}):(0,t.jsx)("div",{className:"avatar-placeholder",children:m(l.fullName)}),(0,t.jsx)("span",{className:"user-name",children:(null===(a=l.fullName)||void 0===a?void 0:a.split(" ")[0])||"User"}),(0,t.jsx)("i",{className:"fas fa-chevron-".concat(c?"up":"down")}),c&&(0,t.jsxs)("div",{className:"dropdown-menu",children:[(0,t.jsx)("div",{className:"dropdown-header",children:(0,t.jsxs)("div",{className:"user-info",children:[l.avatar?(0,t.jsx)("img",{src:l.avatar,alt:l.fullName}):(0,t.jsx)("div",{className:"avatar-small",children:m(l.fullName)}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:l.fullName}),(0,t.jsx)("span",{children:l.email})]})]})}),(0,t.jsx)("div",{className:"dropdown-divider"}),(0,t.jsxs)("button",{className:"dropdown-item",onClick:()=>{(()=>{const e=localStorage.getItem("user");e?"admin"===JSON.parse(e).role?n("/admin"):n("/dashboard"):n("/login")})(),d(!1)},children:[(0,t.jsx)("i",{className:"fas fa-tachometer-alt"}),"Dashboard"]}),(0,t.jsxs)("button",{className:"dropdown-item",onClick:()=>{n("/add-content"),d(!1)},children:[(0,t.jsx)("i",{className:"fas fa-plus-circle"}),"Add Content"]}),(0,t.jsxs)("button",{className:"dropdown-item",onClick:()=>{n("/profile"),d(!1)},children:[(0,t.jsx)("i",{className:"fas fa-user-cog"}),"Edit Profile"]}),(0,t.jsx)("div",{className:"dropdown-divider"}),(0,t.jsxs)("button",{className:"dropdown-item logout",onClick:()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),i(null),d(!1),n("/login")},children:[(0,t.jsx)("i",{className:"fas fa-sign-out-alt"}),"Logout"]})]})]}):(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("button",{className:"btn btn-primary",onClick:()=>n("/reg"),children:[(0,t.jsx)("i",{className:"fas fa-user-plus"}),"Sign Up"]})})]}):(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>n("/login"),children:"Get Started"})})]})}},337(e,a,s){s.r(a),s.d(a,{default:()=>c});var o=s(555),r=s(43),t=s(368),n=s(302),l=s(768),i=s(579);const c=function(){var e;const{id:a}=(0,t.g)(),s=(0,t.Zp)(),[c,d]=(0,r.useState)(null),[m,u]=(0,r.useState)(!0),[h,v]=(0,r.useState)(null),[p,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{f()},[a]);const f=async()=>{try{u(!0);const e=await(0,l.vW)(a);if(!e.success)throw new Error(e.message||"Failed to load note");{const a=e.note;console.log("Fetched note:",a),console.log("Google Drive Link:",a.googleDriveLink);let s=null;if(a.googleDriveLink){const e=j(a.googleDriveLink);console.log("Extracted Google Drive ID:",e),e&&(s="https://drive.google.com/file/d/".concat(e,"/preview"),console.log("Generated embed URL:",s))}d((0,o.A)((0,o.A)({},a),{},{embedUrl:s}))}}catch(e){console.error("Error fetching note:",e),v(e.message||"Failed to load PDF")}finally{u(!1)}},j=e=>{if(!e)return null;e=decodeURIComponent(e);const a=[/\/file\/d\/([a-zA-Z0-9_-]+)/,/open\?id=([a-zA-Z0-9_-]+)/,/[\?&]id=([a-zA-Z0-9_-]+)/,/([a-zA-Z0-9_-]{25,})/];for(const s of a){const a=e.match(s);if(a&&a[1])return a[1]}return null},x=()=>{c&&c.googleDriveLink&&window.open(c.googleDriveLink,"_blank")};return m?(0,i.jsxs)("div",{className:"pdf-viewer-container",children:[(0,i.jsx)(n.A,{}),(0,i.jsxs)("div",{className:"loading-container",children:[(0,i.jsx)("div",{className:"spinner"}),(0,i.jsx)("p",{children:"Loading PDF..."})]})]}):h||!c?(0,i.jsxs)("div",{className:"pdf-viewer-container",children:[(0,i.jsx)(n.A,{}),(0,i.jsxs)("div",{className:"error-container",children:[(0,i.jsx)("i",{className:"fas fa-exclamation-triangle"}),(0,i.jsx)("h3",{children:h||"PDF Not Found"}),(0,i.jsx)("p",{children:h?"Please try again later":"The PDF content could not be loaded."}),(0,i.jsxs)("button",{onClick:()=>s("/pdf"),className:"back-btn",children:[(0,i.jsx)("i",{className:"fas fa-arrow-left"})," Back to PDF Library"]})]})]}):(0,i.jsxs)("div",{className:"pdf-viewer-container",children:[(0,i.jsx)(n.A,{}),(0,i.jsxs)("div",{className:"pdf-viewer-wrapper",children:[(0,i.jsxs)("div",{className:"pdf-sidebar",children:[(0,i.jsxs)("button",{className:"back-btn",onClick:()=>s("/pdf"),children:[(0,i.jsx)("i",{className:"fas fa-arrow-left"})," Back to Library"]}),(0,i.jsxs)("div",{className:"sidebar-card",children:[(0,i.jsx)("div",{className:"thumbnail-container",children:c.thumbnail?(0,i.jsx)("img",{src:c.thumbnail.startsWith("http")?c.thumbnail:"http://localhost:5000".concat(c.thumbnail),alt:c.title,onError:e=>{e.target.onerror=null,e.target.src="https://images.unsplash.com/photo-1501504905252-473c47e087f8?w=400&auto=format&fit=crop"}}):(0,i.jsx)("div",{className:"placeholder-thumbnail",children:(0,i.jsx)("i",{className:"fas fa-file-pdf"})})}),(0,i.jsxs)("div",{className:"info-section",children:[(0,i.jsx)("h3",{children:c.title}),(0,i.jsxs)("div",{className:"author",children:["By ",c.authorName||(null===(e=c.author)||void 0===e?void 0:e.fullName)||"Unknown Author"]}),(0,i.jsx)("p",{className:"description",children:c.description||"No description available"})]}),(0,i.jsxs)("div",{className:"meta-section",children:[(0,i.jsxs)("div",{className:"meta-item",children:[(0,i.jsx)("i",{className:"fas fa-folder"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"meta-label",children:"Category"}),(0,i.jsx)("span",{className:"meta-value",children:c.category})]})]}),(0,i.jsxs)("div",{className:"meta-item",children:[(0,i.jsx)("i",{className:"fas fa-calendar"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"meta-label",children:"Uploaded"}),(0,i.jsx)("span",{className:"meta-value",children:new Date(c.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]})]}),c.pages&&c.pages>0&&(0,i.jsxs)("div",{className:"meta-item",children:[(0,i.jsx)("i",{className:"fas fa-file"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"meta-label",children:"Pages"}),(0,i.jsxs)("span",{className:"meta-value",children:[c.pages," pages"]})]})]}),(0,i.jsxs)("div",{className:"meta-item",children:[(0,i.jsx)("i",{className:"fas fa-download"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"meta-label",children:"Downloads"}),(0,i.jsx)("span",{className:"meta-value",children:c.downloads||0})]})]})]}),c.tags&&c.tags.length>0&&(0,i.jsxs)("div",{className:"tags-section",children:[(0,i.jsx)("span",{className:"meta-label",children:"Tags"}),(0,i.jsx)("div",{className:"pdf-tags",children:c.tags.map((e,a)=>(0,i.jsx)("span",{className:"tag",children:e},a))})]}),(0,i.jsxs)("div",{className:"sidebar-footer",children:[c.embedUrl&&!p&&(0,i.jsxs)("button",{className:"action-btn full-screen-btn",onClick:()=>window.open(c.embedUrl,"_blank"),children:[(0,i.jsx)("i",{className:"fas fa-expand"})," Full Screen"]}),(0,i.jsxs)("button",{className:"action-btn",onClick:()=>{window.print()},children:[(0,i.jsx)("i",{className:"fas fa-print"})," Print"]}),(0,i.jsxs)("button",{className:"action-btn primary",onClick:x,children:[(0,i.jsx)("i",{className:"fas fa-download"})," Download"]})]})]})]}),(0,i.jsx)("div",{className:"pdf-main",children:(0,i.jsx)("div",{className:"pdf-viewer",children:c.embedUrl&&!p?(0,i.jsx)("iframe",{src:c.embedUrl,title:c.title,className:"google-drive-iframe",allow:"autoplay",allowFullScreen:!0,onError:e=>{console.error("Iframe failed to load"),g(!0),e.target.style.display="none"}}):c.googleDriveLink?(0,i.jsxs)("div",{className:"no-pdf-available",children:[(0,i.jsx)("i",{className:"fas fa-file-pdf"}),(0,i.jsx)("h3",{children:"PDF Preview Not Available"}),(0,i.jsx)("p",{children:"This PDF cannot be previewed. Please download to view."}),(0,i.jsxs)("div",{className:"fallback-buttons",children:[(0,i.jsxs)("button",{className:"action-btn secondary",onClick:()=>window.open(c.googleDriveLink,"_blank"),children:[(0,i.jsx)("i",{className:"fas fa-external-link-alt"})," Open in Browser"]}),(0,i.jsxs)("button",{className:"action-btn primary",onClick:x,children:[(0,i.jsx)("i",{className:"fas fa-download"})," Download PDF"]})]})]}):(0,i.jsxs)("div",{className:"no-pdf-available",children:[(0,i.jsx)("i",{className:"fas fa-exclamation-triangle"}),(0,i.jsx)("h3",{children:"No PDF Available"}),(0,i.jsx)("p",{children:"This note doesn't have an associated PDF file."})]})})})]})]})}},768(e,a,s){s.d(a,{CS:()=>f,DA:()=>h,DY:()=>l,E0:()=>u,Fj:()=>x,K3:()=>v,Lx:()=>i,NJ:()=>m,cs:()=>g,dE:()=>w,lo:()=>b,mc:()=>p,nI:()=>N,r7:()=>c,tO:()=>d,vW:()=>j});var o=s(555),r=s(722);const t="https://e-siksha-3tzs.onrender.com",n=r.A.create({baseURL:t,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{const a=localStorage.getItem("token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var a;return 401===(null===(a=e.response)||void 0===a?void 0:a.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});const l=async e=>{try{const a=await n.post("/register",e);return a.data.token&&(localStorage.setItem("token",a.data.token),localStorage.setItem("user",JSON.stringify(a.data.user))),a.data}catch(o){var a,s;throw console.error("Registration error:",(null===(a=o.response)||void 0===a?void 0:a.data)||o.message),(null===(s=o.response)||void 0===s?void 0:s.data)||{success:!1,message:"Registration failed"}}},i=async e=>{try{const a=await n.post("/login",e);return a.data.token&&(localStorage.setItem("token",a.data.token),localStorage.setItem("user",JSON.stringify(a.data.user))),a.data}catch(o){var a,s;throw console.error("Login error:",(null===(a=o.response)||void 0===a?void 0:a.data)||o.message),(null===(s=o.response)||void 0===s?void 0:s.data)||{success:!1,message:"Login failed"}}},c=async e=>{try{const a=new FormData;Object.keys(e).forEach(s=>{"skills"===s&&Array.isArray(e[s])?a.append(s,JSON.stringify(e[s])):("avatar"===s&&(e[s],File),a.append(s,e[s]))});const s=localStorage.getItem("token"),r=await fetch("".concat(t,"/user/profile"),{method:"PUT",headers:{Authorization:"Bearer ".concat(s)},body:a}),n=await r.json();if(!r.ok)throw n;if(n.user){const e=JSON.parse(localStorage.getItem("user")||"{}");localStorage.setItem("user",JSON.stringify((0,o.A)((0,o.A)({},e),n.user)))}return n}catch(s){var a;throw console.error("Update profile error:",s),(null===(a=s.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to update profile"}}},d=async()=>{try{return(await n.get("/user/dashboard")).data}catch(s){var e,a;throw console.error("Dashboard error:",(null===(e=s.response)||void 0===e?void 0:e.data)||s.message),(null===(a=s.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to load dashboard"}}},m=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await n.get("/courses",{params:e})).data}catch(o){var a,s;throw console.error("Get courses error:",(null===(a=o.response)||void 0===a?void 0:a.data)||o.message),(null===(s=o.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to load courses"}}},u=async e=>{try{return(await n.get("/courses/".concat(e))).data}catch(o){var a,s;throw console.error("Get course error:",(null===(a=o.response)||void 0===a?void 0:a.data)||o.message),(null===(s=o.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to load course"}}},h=async e=>{try{return(await n.post("/courses/".concat(e,"/enroll"))).data}catch(o){var a,s;throw console.error("Enroll error:",(null===(a=o.response)||void 0===a?void 0:a.data)||o.message),(null===(s=o.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to enroll in course"}}},v=async(e,a)=>{try{return(await n.post("/courses/".concat(e,"/progress"),a)).data}catch(r){var s,o;throw console.error("Progress error:",(null===(s=r.response)||void 0===s?void 0:s.data)||r.message),(null===(o=r.response)||void 0===o?void 0:o.data)||{success:!1,message:"Failed to update progress"}}},p=async e=>{try{const a=localStorage.getItem("token"),s=await fetch("".concat(t,"/courses/submit"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:e}),o=await s.json();if(!s.ok)throw o;return o}catch(a){throw console.error("Submit course error:",a),a}},g=async e=>{try{const a=localStorage.getItem("token"),s=await fetch("".concat(t,"/notes/submit"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:e}),o=await s.json();if(!s.ok)throw o;return o}catch(a){throw console.error("Error submitting notes:",a),a}},f=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await n.get("/notes",{params:e})).data}catch(o){var a,s;throw console.error("Get notes error:",(null===(a=o.response)||void 0===a?void 0:a.data)||o.message),(null===(s=o.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to load notes"}}},j=async e=>{try{return(await n.get("/notes/".concat(e))).data}catch(o){var a,s;throw console.error("Get note error:",(null===(a=o.response)||void 0===a?void 0:a.data)||o.message),(null===(s=o.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to load note"}}},x=async()=>{try{return(await n.get("/admin/pending")).data}catch(s){var e,a;throw console.error("Pending content error:",(null===(e=s.response)||void 0===e?void 0:e.data)||s.message),(null===(a=s.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to load pending content"}}},N=async function(e,a,s){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";try{return(await n.post("/admin/content/".concat(e,"/").concat(a,"/approve"),{action:s,reason:o})).data}catch(l){var r,t;throw console.error("Approve content error:",(null===(r=l.response)||void 0===r?void 0:r.data)||l.message),(null===(t=l.response)||void 0===t?void 0:t.data)||{success:!1,message:"Failed to process content"}}},w=async()=>{try{return(await n.get("/admin/stats")).data}catch(s){var e,a;throw console.error("Admin stats error:",(null===(e=s.response)||void 0===e?void 0:e.data)||s.message),(null===(a=s.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to load stats"}}},b=async()=>{try{return(await n.get("/admin/users")).data}catch(s){var e,a;throw console.error("Get users error:",(null===(e=s.response)||void 0===e?void 0:e.data)||s.message),(null===(a=s.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to load users"}}}}}]);
//# sourceMappingURL=337.0235f264.chunk.js.map