"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[298],{298(e,s,a){a.r(s),a.d(s,{default:()=>c});var t=a(555),o=a(43),r=a(368),n=a(768),i=a(579);const c=function(){const{id:e}=(0,r.g)(),s=(0,r.Zp)(),a=(0,o.useRef)(null),[c,l]=(0,o.useState)(null),[d,u]=(0,o.useState)(0),[m,h]=(0,o.useState)(!1),[v,p]=(0,o.useState)(""),[g,j]=(0,o.useState)(!0),[x,y]=(0,o.useState)(null),[N,f]=(0,o.useState)([]),[w,S]=(0,o.useState)({});(0,o.useEffect)(()=>{b(),k()},[e]);const b=async()=>{try{j(!0);const a=await(0,n.E0)(e);if(!a.success)throw new Error(a.message||"Failed to load course");{var s;const e=a.course;console.log("Fetched course for video player:",e);const o=(null===(s=e.modules)||void 0===s?void 0:s.flatMap((e,s)=>e.videos.map(a=>(0,t.A)((0,t.A)({},a),{},{moduleId:e._id||s,moduleName:e.title,moduleIndex:s}))))||[];l((0,t.A)((0,t.A)({},e),{},{allVideos:o,currentVideo:o[0]||null})),e.modules&&e.modules.length>0&&S({[e.modules[0]._id||0]:!0}),y(null)}}catch(a){console.error("Course fetch error:",a),y(a.message||"Failed to load course")}finally{j(!1)}},k=()=>{try{const s=JSON.parse(localStorage.getItem("videoNotes")||"{}"),a=Object.values(s).filter(s=>s.courseId===e);f(a)}catch(s){console.error("Load notes error:",s),f([])}};if(g)return(0,i.jsx)("div",{className:"video-player-wrapper",children:(0,i.jsxs)("div",{className:"loading-container",children:[(0,i.jsx)("div",{className:"spinner"}),(0,i.jsx)("p",{children:"Loading video player..."})]})});if(x||!c)return(0,i.jsx)("div",{className:"video-player-wrapper",children:(0,i.jsxs)("div",{className:"error-container",children:[(0,i.jsx)("i",{className:"fas fa-exclamation-triangle"}),(0,i.jsx)("h3",{children:x||"Course not found"}),(0,i.jsx)("p",{children:x?"Please try again later":"The course content could not be loaded."}),(0,i.jsx)("button",{onClick:()=>s("/list"),className:"btn-primary",children:"Browse Courses"})]})});const I=c.currentVideo,C=!(null===I||void 0===I||!I.url)&&(!!(F=I.url)&&(F.includes("youtube.com")||F.includes("youtu.be")));var F;const A=C?(e=>{if(!e)return null;const s=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]{11}).*/);return s&&s[2]?s[2]:null})(I.url):null;return(0,i.jsxs)("div",{className:"video-player-wrapper",children:[(0,i.jsxs)("header",{className:"video-header",children:[(0,i.jsx)("button",{className:"back-btn",onClick:()=>s("/course/".concat(e)),children:"\u2190 Back to Course"}),(0,i.jsx)("h2",{children:c.title}),(0,i.jsxs)("div",{className:"header-actions",children:[(0,i.jsxs)("button",{className:"notes-btn",onClick:()=>h(!m),children:[(0,i.jsx)("i",{className:"fas fa-sticky-note"})," ",m?"Hide":"Notes"]}),(0,i.jsxs)("button",{className:"download-btn",onClick:()=>{C&&A?window.open("https://www.youtube.com/watch?v=".concat(A),"_blank"):window.open(null===I||void 0===I?void 0:I.url,"_blank")},children:[(0,i.jsx)("i",{className:"fas fa-external-link-alt"})," Open in New Tab"]})]})]}),(0,i.jsxs)("div",{className:"video-content-wrapper",children:[c.modules&&c.modules.length>0&&(0,i.jsxs)("div",{className:"playlist-sidebar",children:[(0,i.jsxs)("div",{className:"sidebar-header",children:[(0,i.jsxs)("h3",{children:[(0,i.jsx)("i",{className:"fas fa-list"})," Course Playlist"]}),(0,i.jsxs)("span",{className:"video-count",children:[c.allVideos.length," videos"]})]}),(0,i.jsx)("div",{className:"playlist-list",children:c.modules.map((s,a)=>{const o=w[s._id||a],r=s.videos||[];return(0,i.jsxs)("div",{className:"module-section",children:[(0,i.jsxs)("div",{className:"module-header",onClick:()=>{return e=s._id||a,void S(s=>(0,t.A)((0,t.A)({},s),{},{[e]:!s[e]}));var e},children:[(0,i.jsx)("i",{className:"fas ".concat(o?"fa-chevron-down":"fa-chevron-right")}),(0,i.jsx)("h4",{children:s.title}),(0,i.jsxs)("span",{className:"module-video-count",children:[r.length," videos"]})]}),o&&(0,i.jsx)("div",{className:"module-videos",children:r.map((o,r)=>{const m=c.allVideos.findIndex(e=>e.url===o.url&&e.title===o.title);return(0,i.jsxs)("div",{id:"video-".concat(m),className:"playlist-item ".concat(d===m?"active":""),onClick:()=>(async(s,a)=>{if(!c)return;l((0,t.A)((0,t.A)({},c),{},{currentVideo:s})),u(a);try{await(0,n.K3)(e,{progress:Math.min(100,(a+1)/c.allVideos.length*100),completed:a===c.allVideos.length-1})}catch(r){console.error("Progress update error:",r)}const o=document.getElementById("video-".concat(a));o&&o.scrollIntoView({behavior:"smooth",block:"center"})})(c.allVideos[m],m),children:[(0,i.jsx)("div",{className:"playlist-item-icon",children:d===m?(0,i.jsx)("i",{className:"fas fa-play-circle"}):(0,i.jsx)("i",{className:"far fa-circle"})}),(0,i.jsxs)("div",{className:"playlist-item-info",children:[(0,i.jsx)("p",{className:"playlist-item-title",children:o.title}),o.duration&&(0,i.jsx)("span",{className:"playlist-item-duration",children:o.duration})]})]},"".concat(s._id||a,"-").concat(r))})})]},s._id||a)})})]}),(0,i.jsx)("div",{className:"video-main-content",children:(0,i.jsxs)("div",{className:"video-main",children:[(0,i.jsx)("div",{className:"video-wrapper",children:C&&A?(0,i.jsx)("iframe",{width:"100%",height:"100%",src:"https://www.youtube.com/embed/".concat(A,"?rel=0&modestbranding=1"),title:(null===I||void 0===I?void 0:I.title)||"".concat(c.title," - Complete Tutorial"),frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"youtube-iframe"}):(0,i.jsx)("video",{ref:a,src:null===I||void 0===I?void 0:I.url,onError:e=>{console.error("Video load error:",e),y("Failed to load video. Please check your connection.")},className:"video-element",controls:!0})}),(0,i.jsxs)("div",{className:"video-info",children:[(0,i.jsx)("h3",{children:(null===I||void 0===I?void 0:I.title)||c.title}),(0,i.jsx)("p",{className:"course-description",children:c.description}),(0,i.jsxs)("div",{className:"course-details",children:[(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("i",{className:"fas fa-clock"}),(0,i.jsxs)("span",{children:[(0,i.jsx)("strong",{children:"Duration:"})," ",(null===I||void 0===I?void 0:I.duration)||c.duration]})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("i",{className:"fas fa-signal"}),(0,i.jsxs)("span",{children:[(0,i.jsx)("strong",{children:"Level:"})," ",c.level]})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("i",{className:"fas fa-user"}),(0,i.jsxs)("span",{children:[(0,i.jsx)("strong",{children:"Instructor:"})," ",c.instructorName]})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("i",{className:"fas fa-tag"}),(0,i.jsxs)("span",{children:[(0,i.jsx)("strong",{children:"Category:"})," ",c.category]})]})]}),x&&(0,i.jsxs)("p",{className:"video-error",children:[(0,i.jsx)("i",{className:"fas fa-exclamation-triangle"})," ",x]})]})]})})]}),m&&(0,i.jsxs)("div",{className:"notes-panel active",children:[(0,i.jsxs)("div",{className:"notes-header",children:[(0,i.jsx)("h3",{children:"My Notes"}),(0,i.jsx)("button",{className:"close-notes",onClick:()=>h(!1),children:(0,i.jsx)("i",{className:"fas fa-times"})})]}),(0,i.jsxs)("div",{className:"notes-content",children:[(0,i.jsxs)("div",{className:"notes-input-section",children:[(0,i.jsx)("textarea",{value:v,onChange:e=>p(e.target.value),placeholder:"Type your notes here...",className:"notes-textarea",rows:"6"}),(0,i.jsxs)("div",{className:"notes-actions",children:[(0,i.jsxs)("button",{className:"save-note",onClick:()=>{if(v.trim()&&c)try{const s="".concat(e,"-").concat(Date.now()),a=c.currentVideo,t={id:s,text:v.trim(),date:(new Date).toISOString(),courseId:e,courseTitle:c.title,videoTitle:a.title,videoIndex:d},o=JSON.parse(localStorage.getItem("videoNotes")||"{}");o[s]=t,localStorage.setItem("videoNotes",JSON.stringify(o)),f(e=>[t,...e]),p(""),alert("Note saved successfully!")}catch(s){console.error("Save note error:",s),alert("Failed to save note")}},children:[(0,i.jsx)("i",{className:"fas fa-save"})," Save Note"]}),(0,i.jsx)("button",{className:"clear-note",onClick:()=>p(""),children:"Clear"})]})]}),(0,i.jsxs)("div",{className:"saved-notes",children:[(0,i.jsxs)("h4",{children:["Saved Notes (",N.length,")"]}),N.length>0?N.map(e=>(0,i.jsxs)("div",{className:"note-item",children:[(0,i.jsx)("p",{children:e.text}),(0,i.jsxs)("div",{className:"note-footer",children:[(0,i.jsxs)("span",{className:"note-time",children:[new Date(e.date).toLocaleDateString()," at ",new Date(e.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,i.jsx)("span",{className:"note-video",children:e.videoTitle}),(0,i.jsx)("button",{className:"delete-note-btn",onClick:()=>(e=>{try{const s=JSON.parse(localStorage.getItem("videoNotes")||"{}");delete s[e],localStorage.setItem("videoNotes",JSON.stringify(s)),f(s=>s.filter(s=>s.id!==e))}catch(s){console.error("Delete note error:",s),alert("Failed to delete note")}})(e.id),children:(0,i.jsx)("i",{className:"fas fa-trash"})})]})]},e.id)):(0,i.jsx)("p",{className:"no-notes",children:"No notes saved yet. Start typing above!"})]})]})]})]})}},768(e,s,a){a.d(s,{CS:()=>j,DA:()=>h,DY:()=>i,E0:()=>m,Fj:()=>y,K3:()=>v,Lx:()=>c,NJ:()=>u,cs:()=>g,dE:()=>f,lo:()=>w,mc:()=>p,nI:()=>N,pU:()=>b,r7:()=>l,tO:()=>d,vE:()=>S,vW:()=>x});var t=a(555),o=a(722);const r="https://e-siksha-mljg.onrender.com/api",n=o.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization="Bearer ".concat(s)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var s;return 401===(null===(s=e.response)||void 0===s?void 0:s.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});const i=async e=>{try{const s=await n.post("/register",e);return s.data.token&&(localStorage.setItem("token",s.data.token),localStorage.setItem("user",JSON.stringify(s.data.user))),s.data}catch(t){var s,a;throw console.error("Registration error:",(null===(s=t.response)||void 0===s?void 0:s.data)||t.message),(null===(a=t.response)||void 0===a?void 0:a.data)||{success:!1,message:"Registration failed"}}},c=async e=>{try{const s=await n.post("/login",e);return s.data.token&&(localStorage.setItem("token",s.data.token),localStorage.setItem("user",JSON.stringify(s.data.user))),s.data}catch(t){var s,a;throw console.error("Login error:",(null===(s=t.response)||void 0===s?void 0:s.data)||t.message),(null===(a=t.response)||void 0===a?void 0:a.data)||{success:!1,message:"Login failed"}}},l=async e=>{try{const s=new FormData;Object.keys(e).forEach(a=>{"skills"===a&&Array.isArray(e[a])?s.append(a,JSON.stringify(e[a])):("avatar"===a&&(e[a],File),s.append(a,e[a]))});const a=localStorage.getItem("token"),o=await fetch("".concat(r,"/user/profile"),{method:"PUT",headers:{Authorization:"Bearer ".concat(a)},body:s}),n=await o.json();if(!o.ok)throw n;if(n.user){const e=JSON.parse(localStorage.getItem("user")||"{}");localStorage.setItem("user",JSON.stringify((0,t.A)((0,t.A)({},e),n.user)))}return n}catch(a){var s;throw console.error("Update profile error:",a),(null===(s=a.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to update profile"}}},d=async()=>{try{return(await n.get("/user/dashboard")).data}catch(a){var e,s;throw console.error("Dashboard error:",(null===(e=a.response)||void 0===e?void 0:e.data)||a.message),(null===(s=a.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to load dashboard"}}},u=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await n.get("/courses",{params:e})).data}catch(t){var s,a;throw console.error("Get courses error:",(null===(s=t.response)||void 0===s?void 0:s.data)||t.message),(null===(a=t.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to load courses"}}},m=async e=>{try{return(await n.get("/courses/".concat(e))).data}catch(t){var s,a;throw console.error("Get course error:",(null===(s=t.response)||void 0===s?void 0:s.data)||t.message),(null===(a=t.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to load course"}}},h=async e=>{try{return(await n.post("/courses/".concat(e,"/enroll"))).data}catch(t){var s,a;throw console.error("Enroll error:",(null===(s=t.response)||void 0===s?void 0:s.data)||t.message),(null===(a=t.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to enroll in course"}}},v=async(e,s)=>{try{return(await n.post("/courses/".concat(e,"/progress"),s)).data}catch(o){var a,t;throw console.error("Progress error:",(null===(a=o.response)||void 0===a?void 0:a.data)||o.message),(null===(t=o.response)||void 0===t?void 0:t.data)||{success:!1,message:"Failed to update progress"}}},p=async e=>{try{const s=localStorage.getItem("token"),a=await fetch("".concat(r,"/courses/submit"),{method:"POST",headers:{Authorization:"Bearer ".concat(s)},body:e}),t=await a.json();if(!a.ok)throw t;return t}catch(s){throw console.error("Submit course error:",s),s}},g=async e=>{try{const s=localStorage.getItem("token"),a=await fetch("".concat(r,"/notes/submit"),{method:"POST",headers:{Authorization:"Bearer ".concat(s)},body:e}),t=await a.json();if(!a.ok)throw t;return t}catch(s){throw console.error("Error submitting notes:",s),s}},j=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await n.get("/notes",{params:e})).data}catch(t){var s,a;throw console.error("Get notes error:",(null===(s=t.response)||void 0===s?void 0:s.data)||t.message),(null===(a=t.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to load notes"}}},x=async e=>{try{return(await n.get("/notes/".concat(e))).data}catch(t){var s,a;throw console.error("Get note error:",(null===(s=t.response)||void 0===s?void 0:s.data)||t.message),(null===(a=t.response)||void 0===a?void 0:a.data)||{success:!1,message:"Failed to load note"}}},y=async()=>{try{return(await n.get("/admin/pending")).data}catch(a){var e,s;throw console.error("Pending content error:",(null===(e=a.response)||void 0===e?void 0:e.data)||a.message),(null===(s=a.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to load pending content"}}},N=async function(e,s,a){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";try{return(await n.post("/admin/content/".concat(e,"/").concat(s,"/approve"),{action:a,reason:t})).data}catch(i){var o,r;throw console.error("Approve content error:",(null===(o=i.response)||void 0===o?void 0:o.data)||i.message),(null===(r=i.response)||void 0===r?void 0:r.data)||{success:!1,message:"Failed to process content"}}},f=async()=>{try{return(await n.get("/admin/stats")).data}catch(a){var e,s;throw console.error("Admin stats error:",(null===(e=a.response)||void 0===e?void 0:e.data)||a.message),(null===(s=a.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to load stats"}}},w=async()=>{try{return(await n.get("/admin/users")).data}catch(a){var e,s;throw console.error("Get users error:",(null===(e=a.response)||void 0===e?void 0:e.data)||a.message),(null===(s=a.response)||void 0===s?void 0:s.data)||{success:!1,message:"Failed to load users"}}},S=async function(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const t=localStorage.getItem("token");if(!t)throw new Error("No authentication token found");const o=await fetch("".concat(r,"/admin/").concat(e,"/").concat(s),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({reason:a})}),n=await o.json();if(!o.ok)throw new Error(n.message||"Failed to delete ".concat(e));return n}catch(t){throw console.error("Error deleting ".concat(e,":"),t),t}},b=async(e,s)=>{try{const a=localStorage.getItem("token");if(!a)throw new Error("No authentication token found");const t=await fetch("".concat(r,"/admin/users/").concat(e,"/status"),{method:"PUT",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({isActive:s})}),o=await t.json();if(!t.ok)throw new Error(o.message||"Failed to update user status");return o}catch(a){throw console.error("Error updating user status:",a),a}}}}]);
//# sourceMappingURL=298.e63a7764.chunk.js.map